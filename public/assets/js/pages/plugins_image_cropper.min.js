$(function(){altair_image_cropper.init()}),altair_image_cropper={init:function(){"use strict";var e=window.console||{log:function(){}},t=$("#image_cropper"),o=$("#image_download"),a={aspectRatio:16/9,preview:".cr_preview"};t.on({"build.cropper":function(t){e.log(t.type)},"built.cropper":function(t){e.log(t.type)},"cropstart.cropper":function(t){e.log(t.type,t.action)},"cropmove.cropper":function(t){e.log(t.type,t.action)},"cropend.cropper":function(t){e.log(t.type,t.action)},"crop.cropper":function(t){e.log(t.type,t.x,t.y,t.width,t.height,t.rotate,t.scaleX,t.scaleY)},"zoom.cropper":function(t){e.log(t.type,t.ratio)}}).cropper(a),$.isFunction(document.createElement("canvas").getContext)||$('button[data-method="getCroppedCanvas"]').prop("disabled",!0),"undefined"==typeof document.createElement("cropper").style.transition&&($('button[data-method="rotate"]').prop("disabled",!0),$('button[data-method="scale"]').prop("disabled",!0)),e.log("undefined"==typeof o[0].download),"undefined"==typeof o[0].download&&o.addClass("disabled"),$(".croper-toggles").on("click","button",function(){if($(this).hasClass("uk-active")){var e=$(this),o=e.attr("data-value");if(!t.data("cropper"))return;t.cropper("setAspectRatio",o)}}),$(".cropper-buttons").on("click","[data-method]",function(){var a,r,p=$(this),n=p.data();if(!p.prop("disabled")&&!p.hasClass("disabled")&&t.data("cropper")&&n.method){if(n=$.extend({},n),"undefined"!=typeof n.target&&(a=$(n.target),"undefined"==typeof n.option))try{n.option=JSON.parse(a.val())}catch(i){e.log(i.message)}switch(r=t.cropper(n.method,n.option,n.secondOption),n.method){case"scaleX":case"scaleY":$(this).data("option",-n.option);break;case"getCroppedCanvas":if(r){var c="#getCroppedCanvasModal",d=UIkit.modal(c);$(c).find(".canvasModalImage").html(r),d.show(),o.hasClass("disabled")||o.attr("href",r.toDataURL("image/jpeg"))}}if($.isPlainObject(r)&&a)try{a.val(JSON.stringify(r))}catch(i){e.log(i.message)}}}),$(document.body).on("keydown",function(e){if(t.data("cropper")&&!(this.scrollTop>300))switch(e.which){case 37:e.preventDefault(),t.cropper("move",-1,0);break;case 38:e.preventDefault(),t.cropper("move",0,-1);break;case 39:e.preventDefault(),t.cropper("move",1,0);break;case 40:e.preventDefault(),t.cropper("move",0,1)}});var r,p,n=$("#inputImage"),i=window.URL||window.webkitURL;i?n.change(function(){var e,o=this.files;t.data("cropper")&&o&&o.length&&(e=o[0],/^image\/\w+$/.test(e.type)?(p=i.createObjectURL(e),t.one("built.cropper",function(){i.revokeObjectURL(p)}).cropper("reset").cropper("replace",p),n.val(""),r=p):window.alert("Please choose an image file."))}):n.prop("disabled",!0).parent().addClass("disabled")}};